
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Amazon GameLift Testing Toolkit">
      
      
        <meta name="author" content="Amazon Web Services">
      
      
        <link rel="canonical" href="https://awslabs.github.io/amazon-gamelift-testing-toolkit/toolkit_design/">
      
      
        <link rel="prev" href="../aws_services/">
      
      
        <link rel="next" href="../security/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.9">
    
    
      
        <title>Toolkit design - Amazon GameLift Testing Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.85bb2934.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#toolkit-components" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Amazon GameLift Testing Toolkit" class="md-header__button md-logo" aria-label="Amazon GameLift Testing Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Amazon GameLift Testing Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Toolkit design
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws-samples/amazon-gamelift-testing-toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Amazon GameLift Testing Toolkit" class="md-nav__button md-logo" aria-label="Amazon GameLift Testing Toolkit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Amazon GameLift Testing Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws-samples/amazon-gamelift-testing-toolkit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quick_start/" class="md-nav__link">
        Quick start
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../using_the_toolkit/" class="md-nav__link">
        Using the toolkit
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../testing_your_game/" class="md-nav__link">
        Testing your game
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../aws_services/" class="md-nav__link">
        AWS services
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Toolkit design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Toolkit design
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#management-console" class="md-nav__link">
    Management console
  </a>
  
    <nav class="md-nav" aria-label="Management console">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ui" class="md-nav__link">
    UI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#management-services-and-data" class="md-nav__link">
    Management services and data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gamelift-listener" class="md-nav__link">
    GameLift listener
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-game" class="md-nav__link">
    Sample game
  </a>
  
    <nav class="md-nav" aria-label="Sample game">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#game-servers" class="md-nav__link">
    Game servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-players" class="md-nav__link">
    Virtual players
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-client-services" class="md-nav__link">
    Game client services
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        Security
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../removing_the_toolkit/" class="md-nav__link">
        Removing the toolkit
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../additional_resources/" class="md-nav__link">
        Additional resources
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#management-console" class="md-nav__link">
    Management console
  </a>
  
    <nav class="md-nav" aria-label="Management console">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ui" class="md-nav__link">
    UI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#management-services-and-data" class="md-nav__link">
    Management services and data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gamelift-listener" class="md-nav__link">
    GameLift listener
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-game" class="md-nav__link">
    Sample game
  </a>
  
    <nav class="md-nav" aria-label="Sample game">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#game-servers" class="md-nav__link">
    Game servers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-players" class="md-nav__link">
    Virtual players
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-client-services" class="md-nav__link">
    Game client services
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="toolkit-components">Toolkit components</h1>
<p>The solution is split into two main parts, the <em>Management console</em>, providing various test capabilities, and the optional <em>Sample game</em>, providing a headless multi-player game for testing.</p>
<h2 id="management-console">Management console</h2>
<p>The console provides various features for testing games with GameLift. It is split into a number of components.</p>
<h3 id="ui">UI</h3>
<p>A simple web interface to configure and control testing. You use the console to configure GameLift, and then create virtual players who are matched with other virtual players before joining game server sessions.</p>
<p>The interface is designed to simplify interacting with GameLift, allowing you to quickly test different match-making and fleet designs, and ensure GameLift is properly tuned for your game.</p>
<p>The UI is implemented as a static website built with <a href="https://phaser.io/">Phaser</a>. The site is hosted in an Amazon S3 bucket which can be accessed through an Amazon CloudFront distribution. User access control is provided by an Amazon Cognito <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-identity-pools.html">user pool</a>.</p>
<h3 id="management-services-and-data">Management services and data</h3>
<p>The web console&#39;s functionality is provided by the management services. The services consist of an API Gateway WebSocket API, which uses <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-control-access-iam.html">IAM authorization</a> for access control and then calls a .NET Core 3.1 Lambda function.</p>
<p>The Lambda function stores WebSocket connection details in a DynamoDB connections table. It then handles a variety of messages from the web console, interacting with a number of resources.</p>
<p>Integrates with GameLift to retrieve game server information, such as fleet details and player sessions, to manage matchmaking, and to retrieve <a href="https://aws.amazon.com/cloudwatch/">Amazon CloudWatch</a> logs.</p>
<p>The DynamoDB tables store the service&#39;s state data, and include a cache of recent GameLift state such as queue events, matchmaking tickets, and game session details.</p>
<p>Launches and terminates virtual players by calling Amazon ECS.</p>
<h3 id="gamelift-listener">GameLift listener</h3>
<p>The GameLift listener is responsible for listening to GameLift event notifications and keeping the management services up-to-date.</p>
<p>The listener defines an Amazon EventBridge management service <a href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-event-bus.html">event bus</a> and subscribes to GameLift matchmaking and queue placement events using <a href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-rules.html">rules</a>. The events are then published to the management services by inserting event data in the corresponding DynamoDB tables.</p>
<p>In addition, there&#39;s an AWS Step Function that regularly calls GameLift, checks its current state, and removes any out-of-date data from the management services&#39; DynamoDB tables.</p>
<h2 id="sample-game">Sample game</h2>
<p>To get started quickly, the toolkit includes an optional sample game, a basic multi-player game allowing you to test GameLift before integrating your game with GameLift.</p>
<h3 id="game-servers">Game servers</h3>
<p>The sample game is a basic .NET game called <em>NumbersQuiz</em>, which pits two players against each other, scoring points by answering arithmetic questions.</p>
<p>A Linux build of the game server is uploaded to GameLift as a <a href="https://docs.aws.amazon.com/gamelift/latest/developerguide/gamelift-build-cli-uploading.html">custom server build</a>, and a couple of On-Demand and Spot <a href="https://docs.aws.amazon.com/gamelift/latest/developerguide/gamelift-ec2-instances.html">fleets</a> are created for hosting games. Finally, a simple matchmaking ruleset is created to enable match-making.</p>
<h3 id="virtual-players">Virtual players</h3>
<p>Virtual players are created by the management services to test the game. Virtual players run as a scripted game client that connects to the Game client services for matchmaking, and then connects to a GameLift game server to play the game.</p>
<p>The virtual player client is installed in a docker image, which is uploaded to a private repository in <a href="https://aws.amazon.com/ecr/">Amazon Elastic Container Registry</a> (Amazon ECR). An Amazon ECS Fargate cluster is also created, along with a <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_definitions.html">task definition</a> referencing the docker image.</p>
<p>The management service can only run task definitions that have a tag called <em>AmazonGameLiftTestingToolkit-VirtualPlayers</em> with a value of   <em>true</em>, restricting its access to ECS task defintions in your account.</p>
<p>When the management service creates new virtual players, it sends requests to ECS to create new tasks, with each task running a container with the game client for a single virtual player. The tasks all run within an <a href="https://aws.amazon.com/vpc/">Amazon Virtual Private Cloud</a> (Amazon VPC).</p>
<h3 id="game-client-services">Game client services</h3>
<p>When a virtual player wants to join a game, the game client calls the game client services to request matchmaking, which matches the virtual player with another player, and replies with details of the GameLift server.</p>
<p>Matchmaking runs in two phases. Firstly, the game client starts matchmaking by sending a request to an API Gateway WebSocket API. The API forwards the request to a Lambda function that calls GameLift and stores the matchmaking ticket in a DynamoDB table. Secondly, once the GameLift listener receives a matchmaking completion event, it calls a Lambda function to update the ticket information in DynamoDB, and tells API Gateway to send the game server information to the clients matched in the ticket.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (c) 2023 by Amazon.com, Inc. or its affiliates.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fac441b0.min.js"></script>
      
    
  </body>
</html>